<!DOCTYPE html>
<html lang="en-US" >
<head>
    <title>brat</title>
    <!--<meta http-equiv="Content-Type" content="application/xhtml+xml; charset=utf-8"/>-->
    <link rel="stylesheet" type="text/css" href="dist/brat-frontend-editor.min.css"/>
    <script type="text/javascript" src="node_modules/headjs/dist/0.98/head.load.min.js"></script>
    <script type="text/javascript">
        head.js(
                // libraries
                'client/lib/jquery.min.js',// 'client/lib/_jquery.min.js',
                'client/lib/jquery-ui.min.js',
                'client/lib/jquery.svg.min.js',
                'client/lib/jquery.svgdom.min.js',
                'node_modules/jquery-bbq/jquery.ba-bbq.min.js', //'client/lib/_jquery.ba-bbq.min.js',
                'client/lib/jquery.sprintf.js',
                'client/lib/jquery.json.min.js',
                'http://ajax.googleapis.com/ajax/libs/webfont/1.4.7/webfont.js',
                // brat helpers
                'client/src/configuration.js',
                'client/src/util.js',
                //'client/src/annotation_log.js', //BRAT STANDALONE LIBRARY as nothing to do with user log management
                // brat modules
                'client/src/dispatcher.js',
                //'client/src/url_monitor.js', //BRAT STANDALONE LIBRARY needs to be URL independant
                'client/src/url_hash.js', //Created by BRAT STANDALONE LIBRARY and removed from trl_monitor since it's used intensively by visualizer and annotator
                'client/src/local_ajax.js',
                'client/src/ajax.js',
                'client/src/visualizer.js',
                'client/src/visualizer_ui.js',
                'client/src/annotator_ui.js',
                'client/src/spinner.js'
        );

        var collData = {
            "messages": [],
            "items": [],
            "ui_names":{
                "entities":"annotation",
                "events":"événements",
                "relations":"relations",
                "attributes":"attributs"
            },
            "search_config": [
                ["Google", "http://www.google.com/search?q=%s"],
                ["Wikipedia", "http://en.wikipedia.org/wiki/Special:Search?search=%s"],
                ["UniProt", "http://www.uniprot.org/uniprot/?sort=score&query=%s"],
                ["EntrezGene", "http://www.ncbi.nlm.nih.gov/gene?term=%s"],
                ["GeneOntology", "http://amigo.geneontology.org/cgi-bin/amigo/search.cgi?search_query=%s&action=new-search&search_constraint=term"],
                ["ALC", "http://eow.alc.co.jp/%s"]
            ],
            "disambiguator_config": [],
            "unconfigured_types":[
                {
                    "borderColor":"darken",
                    "arrowHead":"triangle,5",
                    "name":"Cause",
                    "color":"#007700",
                    "labels":[
                        "Cause"
                    ],
                    "unused":true,
                    "bgColor":"lightgreen",
                    "type":"Cause",
                    "fgColor":"black"
                }
            ],
            "entity_types": [
                {
                    "name": "Person",
                    "type"   : "Person",
                    "labels" : ["Per", "P"],
                    "bgColor": "#FE2E2E",
                    "borderColor": "darken",
                    "children": [],
                    "unused": false,
                    "attributes": [
                        "Notorious", "Polarity"
                    ],
                    "arcs": [{
                        "arrowHead": "triangle,5",
                        "color": "black",
                        "labels": ["Ennemy", "Enn"],
                        "dashArray": ",",
                        "hotkey": "T",
                        "type": "Ennemy",
                        "targets": ["Person"]
                    },
                    {
                        "arrowHead": "triangle,5",
                        "color": "black",
                        "labels": ["Friend", "Fr"],
                        "dashArray": ",",
                        "hotkey": "T",
                        "type": "Friend",
                        "targets": ["Person"]
                    },
                    {
                        "arrowHead": "triangle,5",
                        "color": "black",
                        "labels": ["Destruction", "Dest"],
                        "dashArray": ",",
                        "hotkey": "T",
                        "type": "Destruction",
                        "targets": ["Object", "Person"]
                    }],
                    "children": [
                        {
                            "name": "Child",
                            "type"   : "Child",
                            "labels" : ["Child", "Child"],
                            "bgColor": "#FE2E2E",
                            "borderColor": "darken",
                            "children": [
                                {
                                    "name": "Baby",
                                    "type"   : "Baby",
                                    "labels" : ["Baby", "Baby"],
                                    "bgColor": "#DF7401",
                                    "borderColor": "darken",
                                    "children": []
                                },
                                {
                                    "name": "Kid",
                                    "type"   : "Kid",
                                    "labels" : ["Kid", "Kid"],
                                    "bgColor": "#FE2E2E",
                                    "borderColor": "darken",
                                    "children": []
                                }
                            ]
                        }/*,
                        {
                            "name": "Teenager",
                            "type"   : "Person",
                            "labels" : ["Person", "Per"],
                            "bgColor": "#FE2E2E",
                            "borderColor": "darken",
                            "children": [],
                        },
                        {
                            "name": "Adult",
                            "type"   : "Adult",
                            "labels" : ["Adult", "Adult"],
                            "bgColor": "#FE2E2E",
                            "borderColor": "darken",
                            "children": []
                        }*/
                    ]
                },
                //null, //will produde <hr> between entity groups or single entities but generate bugs with current code
                {
                    "name": "Object",
                    "type"   : "Object",
                    "labels" : ["Object", "Obj"],
                    "bgColor": "#7fa2ff",
                    "borderColor": "darken",
                    "attributes": [],
                    "children": [],
                    "unused": false,
                    "arcs": [{
                        "arrowHead": "triangle,5",
                        "color": "black",
                        "labels": ["Destruction", "Dest"],
                        "dashArray": ",",
                        "hotkey": "T",
                        "type": "Destruction",
                        "targets": ["Object", "Person"]
                    }]
                }],
            "event_attribute_types": [
                {
                    "labels": null,
                    "type":"Confidence",
                    "name":"Confidence",
                    "unused":false,
                    "values":{
                        "Certain":{
                            "dashArray":","
                        },
                        "Likely":{
                            "dashArray":"3,3"
                        },
                        "Possible":{
                            "dashArray":"3,6"
                        }
                    }
                },
                {
                    "labels": null,
                    "type":"BombType", //Renaud, make sure type has no space in it, it is used as a jquery selector class
                    "name":"BombType",
                    "unused":false,
                    "values":{
                        "Nuclear bomb": {},
                        "Neutron bomb": {},
                        "Napalm bomb": {},
                        "Hydrogen bomb": {}
                    }
                },
                {
                    "name": "Epic",
                    "type"  : "Epic",
                    "values": { "Epic": { "glyph": "★★★" } }
                }
            ],
            "entity_attribute_types": [
                {
                    "name": "Notorious",
                    "type"  : "Notorious",
                    "values": { "Notorious": { "glyph": "★" } }
                },
                {
                    "type": "Polarity",
                    "name": "Polarity",
                    "values": {
                        "Positive": {
                            "box": "none",
                            "glyph": "\n[Polarity:true]",
                            "dashArray": "1,2"
                        },
                        "Negative": {
                            "box": "crossed",
                            "glyph": "\n[Polarity:false]",
                            "dashArray": "3,4"
                        }
                    }
                }
            ],
            "relation_attribute_types": [
                {
                    "labels": null,
                    "type":"RelConfidence",
                    "name":"Relation Confidence",
                    "unused":false,
                    "values":{
                        "Certain":{
                            "dashArray":","
                        },
                        "Likely":{
                            "dashArray":"3,3"
                        },
                        "Possible":{
                            "dashArray":"3,6"
                        }
                    }
                },
                {
                    "name": "Safe",
                    "type"  : "Safe",
                    "values": { "Safe": {} }
                }
            ],
            "relation_types": [
                {
                    "type"     : "Destruction",
                    "labels"   : ["Destruction", "Dest"],
                    "dashArray": "3,3",
                    "color"    : "purple",
                    "args"     : [
                        {"role": "Destructor", "targets": ["Person", "Object"] },
                        {"role": "Destroyed",  "targets": ["Person", "Object"] }
                    ]
                },
                {
                    "type"     : "Friend",
                    "labels"   : ["Friend", "Fr"],
                    "dashArray": "3,3",
                    "color"    : "purple",
                    "attributes": [
                        "RelConfidence", "Safe"
                    ],
                    "args"     : [
                        {"role": "From", "targets": ["Person"] },
                        {"role": "To",  "targets": ["Person"] }
                    ]
                },
                {
                    "type"     : "Ennemy",
                    "labels"   : ["Ennemy", "Enn"],
                    "dashArray": "3,3",
                    "color"    : "purple",
                    "args"     : [
                        {"role": "From", "targets": ["Person"] },
                        {"role": "To",  "targets": ["Person"] }
                    ]
                },
                {
                    "type"     : "Perpetrator",
                    "labels"   : ["Perpetrator", "Perp"],
                    "dashArray": "3,3",
                    "color"    : "purple",
                    "args"     : [
                        {"role": "From", "targets": ["Assassination"] },
                        {"role": "To",  "targets": ["Person"] }
                    ]
                }
            ],
            "event_types": [
                {
                    "name": "Assassination",
                    "type"   : "Assassination",
                    "labels" : ["Assassination", "Assas"],
                    "bgColor": "lightgreen",
                    "borderColor": "darken",
                    "attributes": [
                        "Epic"
                    ],
                    "children": [],
                    "unused": false,
                    "arcs"   : [
                        {
                            "type": "Victim",
                            "labels": [
                                "Victim",
                                "Vict"
                            ],
                            targets: [
                                "Person"
                            ],
                        },
                        {
                            "type": "Perpetrator",
                            "labels": [
                                "Perpetrator",
                                "Perp"
                            ],
                            targets: [
                                "Person"
                            ],
                            "color": "green"
                        }
                    ]
                },
                {
                    "name": "Bomb",
                    "type"   : "Bomb",
                    "labels" : ["Bomb", "Bomb"],
                    "bgColor": "gold",
                    "borderColor": "darken",
                    "attributes": [
                        "BombType"
                    ],
                    "children": [],
                    "unused": false,
                    "arcs"   : [
                        {
                            "type": "Destroyed",
                            "labels": ["Destroyed","Dest"],
                            "color": "gold"
                        }
                    ]
                },
                {
                    "name": "Resurrection",
                    "type"   : "Resurrection",
                    "labels" : ["Resurrection", "Resur"],
                    "bgColor": "magenta",
                    "borderColor": "darken",
                    "attributes": [
                        "Epic", "Confidence"
                    ],
                    "children": [],
                    "unused": false,
                    "arcs"   : [
                        {
                            "type": "Resurrected",
                            "labels": ["Resurrected","Resur"],
                            "color": "magenta"
                        },
                        {
                            //"arrowHead": "triangle,5",
                            //"dashArray": ",",
                            //"hotkey": "T",
                            //"targets": [],
                            "type": "Savior",
                            "labels": ["Savior","Sav"],
                            "color": "magenta"
                        }
                    ]
                }
            ]
        };

        var docData = {
            "messages": [],
            "source_files": ["ann", "txt"],
            "modifications": [],
            "normalizations": [],
            "ctime": 1351154734.5055847,
            "text"     : "Ed O'Kelley was the man who shot the man who shot Jesse James.\nJ'ai lancé une bombe nucléaire sur Simon, Gustav et Pavel... sans raison particulière. Nos trois comparses se ne pouvant se venger sont allés directement au Paradis. Cette histoire est vraie. Ceci est la fin du paragraphe.\n Ceci est le second paragraphe. C'est l'histoire du petit castor le plus petit, mais le plus fort.",
            "entities" : [
                ["N1", "Person", [[0, 2], [5, 11]]], //TODO, name text-bound annotations Tn to be coherent with standoff brat format http://brat.nlplab.org/standoff.html
                //["N2", "Person", [[20, 55], [55, 90], [90,124]]],
                ["N3", "Person", [[37, 40]]],
                ["N4", "Object", [[78, 83], [84, 93]]],
                ["N5", "Person", [[98, 104]]],
                ["N6", "Person", [[105, 111]]],
                ["N7", "Person", [[115, 120]]],
                ["N8", "Person", [[50, 61]]]
            ],
            "attributes": [
                ["A1", "Notorious", "N4"],
                ["A2", "Polarity", "N1", "Positive"],
                ["A3", "Polarity", "N2", "Negative"],
                ["A4", "Epic", "T1"],
                ["A5", "Safe", "R1"]//Relation attributes ignored by client at this point
            ],
            "relations": [
                ["R1", "Friend", [["From", "N2"], ["To", "N1"]]]
            ],
            "triggers": [
                ["T1", "Assassination", [[45, 49]]],
                ["T2", "Resurrection", [[28, 32]]],
                ["T3", "Bomb", [[78, 93]]]
            ],
            "events": [
                ["E1", "T1", [["Perpetrator", "N3"], ["Victim", "N8"]]],
                ["E2", "T2", [["Savior", "N2"], ["Resurrected", "N3"]]],
                ["E3", "T3", [["Destroyed", "N5"], ["Destroyed", "N6"], ["Destroyed", "N7"]]]
            ],
            "comments":[
                ["N1", "AnnotatorNotes", "test comment"]
            ]
        };

        head.ready(function() {
            // var dispatcher = new Dispatcher(); // XXX DEBUG
            dispatcher = new Dispatcher();
            //var urlMonitor = new URLMonitor(dispatcher);
            var ajax = new LocalAjax(dispatcher);
            var visualizer = new Visualizer(dispatcher, 'svg');
            var svg = visualizer.svg;
            var visualizerUI = new VisualizerUI(dispatcher, svg);
            var annotatorUI = new AnnotatorUI(dispatcher, svg);
            var spinner = new Spinner(dispatcher, '#spinner');
            //var logger = new AnnotationLog(dispatcher);
            // Util.profileEnable();
            dispatcher.post('init');

            docData.collection = null;
            dispatcher.post('collectionLoaded', [collData]);
            dispatcher.post('requestRenderData', [docData]);
            dispatcher.post('current', [collData, docData, {}]);
        });

    </script>
    <link rel="shortcut icon" type="image/x-icon" href="favicon.ico"/>
</head>
<body>

<!--TODO: Move inside the component-->
<img id="spinner" src="static/img/spinner.gif"/>
<div id="commentpopup"></div>
<div id="svg"></div>


<!-- Span dialog (view+edit) -->
<form id="span_form" class="dialog" title="Span">
    <!-- Span dialog annotated text -->
    <fieldset id="span_selected_fset">
        <legend>Text</legend>
        <a target="brat_linked" id="span_highlight_link" href="#">Link</a>
        <div id="span_selected"/>
    </fieldset>
    <!-- Span dialog search links -->
    <fieldset id="span_search_fieldset">
        <legend>Search</legend>
        <div id="span_search_links"/>
    </fieldset>
    <!-- Span dialog type selector -->
    <fieldset>
        <div id="entity_and_event_wrapper" class="split_wrapper">
            <div id="span_entity_section" class="wrapper_half_left">
                <div id="entity_label" class="label-like">
                    Entity type
                </div>
                <div id="entity_types" class="scroll_wrapper_upper">
                    <div class="scroller"></div>
                </div>
                <!-- NOTE: the attribute labels must be *outside* of the
                     divs they logically belong to prevent scrollers
                     overflowing them. -->
                <div id="entity_attribute_label" class="label-like wrapper_lower_label">
                    Entity attributes
                </div>
                <div id="entity_attributes" class="scroll_wrapper_lower">
                    <div class="scroller small-buttons"></div>
                </div>
            </div>
            <div id="span_event_section" class="wrapper_half_right">
                <div id="event_label" class="label-like">
                    Event type
                </div>
                <div id="event_types" class="scroll_wrapper_upper">
                    <div class="scroller"></div>
                </div>
                <div id="event_attribute_label" class="wrapper_lower_label label-like">
                    Event attributes
                </div>
                <div id="event_attributes" class="scroll_wrapper_lower">
                    <div class="scroller small-buttons"></div>
                </div>
            </div>
        </div>
    </fieldset>
    <!-- Span dialog normalization -->
    <fieldset id="norm_fieldset">
        <legend>Normalization</legend>
        <div id="norm_container">
            <select id="span_norm_db"/>
            <a id="span_norm_db_link" target="brat_linked" href="#" title="Search DB"><img src="static/img/Fugue-shadowless-magnifier.png" style="vertical-align: middle"/></a>
            <span class="span_norm_label">ID:</span>
            <input id="span_norm_id" class="span_norm_id_input"
                   style="width:20%"/>
            <span class="span_norm_label">Ref:</span>
            <input id="span_norm_txt" class="span_norm_txt_input"
                   readonly="readonly" style="width:45%"
                   placeholder="Click here to search"/>
            <a id="span_norm_ref_link" target="brat_linked" href="#" title="See in DB"><img src="static/img/Fugue-shadowless-external.png" style="vertical-align: middle"/></a>
            <input id="clear_norm_button" type="button"
                   value="&#x2715;" title="Clear normalization"/>
        </div>
    </fieldset>
    <!-- Span dialog notes -->
    <fieldset>
        <legend>Notes</legend>
        <div id="notes_container">
            <input id="span_notes" class="borderless"/>
            <input id="clear_notes_button" type="button"
                   value="&#x2715;" title="Clear notes"/>
        </div>
    </fieldset>
</form>

<!-- Rapid mode span dialog -->
<form id="rapid_span_form" class="dialog" title="Span type">
    <fieldset id="rapid_span_selected_fset">
        <legend>Text</legend>
        <div id="rapid_span_selected"/>
    </fieldset>
    <div id="rapid_span_types" class="scroll_fset" style="height:250px">
        <fieldset>
            <legend>Select type</legend>
            <div class="scroller" id="rapid_span_types_div">
                <!-- filled dynamically -->
            </div>
        </fieldset>
    </div>
</form>

<!-- Arc dialog -->
<form id="arc_form" class="dialog" title="Arc">
    <fieldset id="arc_origin_fset">
        <legend>From</legend>
        <a target="brat_linked" id="arc_highlight_link" href="#">Link</a>
        <div id="arc_origin"/>
    </fieldset>

    <fieldset id="arc_target_fset">
        <legend>To</legend>
        <div id="arc_target"/>
    </fieldset>

    <div id="arc_roles" class="scroll_fset">
        <fieldset>
            <legend>Type</legend>
            <div class="scroller"/>
        </fieldset>
    </div>

    <fieldset id="arc_notes_fieldset">
        <legend>Notes</legend>
        <input id="arc_notes" class="borderless"/>
    </fieldset>

</form>

<!-- Split span annotation dialog -->
<form id="split_form" class="dialog" title="Split the Span">
    <fieldset>
        <legend>Split Roles</legend>
        <div id="split_roles" class="scroll_fset"/>
    </fieldset>
</form>

<!-- Spinner -->
<div id="waiter" class="dialog" title="Please wait">
    <img src="static/img/spinner.gif"/>
</div>
</body>
</html>
